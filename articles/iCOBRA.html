<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iCOBRA User Guide • iCOBRA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="iCOBRA User Guide">
<meta property="og:description" content="iCOBRA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">iCOBRA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.15.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/iCOBRA.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/markrobinsonuzh/iCOBRA/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>iCOBRA User Guide</h1>
                        <h4 class="author">Charlotte Soneson</h4>
            
            <h4 class="date">2020-04-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/markrobinsonuzh/iCOBRA/blob/master/vignettes/iCOBRA.Rmd"><code>vignettes/iCOBRA.Rmd</code></a></small>
      <div class="hidden name"><code>iCOBRA.Rmd</code></div>

    </div>

    
    
<p>iCOBRA is a package to calculate and visualize performance metrics for ranking and binary assignment methods. A typical use case could be, for example, comparing methods calling differential expression in gene expression experiments, which could be seen as either a ranking problem (estimating the correct effect size and ordering the genes by significance) or a binary assignment problem (classifying the genes into differentially expressed and non-differentially expressed).</p>
<p>For more detailed information regarding the calculations, handling of missing values etc, please consult the “Instructions” tab of the shiny application, available via the function <code><a href="../reference/COBRAapp.html">COBRAapp()</a></code>.</p>
<div id="basic-workflow" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-workflow" class="anchor"></a>Basic workflow</h1>
<div id="creating-a-data-set" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-data-set" class="anchor"></a>Creating a data set</h2>
<p>The starting point for an evaluation is typically a collection of feature ‘scores’ (p-values, adjusted p-values or any other ranking score) and the truth (information about the true status, or the true scores for the features). These values are stored in an <code>COBRAData</code> object. Here, we will start from an example <code>COBRAData</code> object provided with the package.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">iCOBRA</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">cobradata_example</span>)
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="no">cobradata_example</span>)</pre></body></html></div>
<pre><code>## [1] "COBRAData"
## attr(,"package")
## [1] "iCOBRA"</code></pre>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">cobradata_example</span></pre></body></html></div>
<pre><code>## An object of class "COBRAData"
## @pval
##                        edgeR         voom       DESeq2
## ENSG00000000457 1.178024e-01 5.147484e-02 1.627063e-02
## ENSG00000000460 1.101413e-01 1.276784e-01 3.281416e-02
## ENSG00000000938 8.128245e-01 8.712829e-01 9.942761e-01
## ENSG00000000971 8.449686e-01 8.939493e-01 9.627826e-01
## ENSG00000001460 8.343203e-21 6.007010e-10 9.303159e-23
## 2394 more rows ...
## 
## @padj
##                        edgeR         voom
## ENSG00000000457 2.833295e-01 1.375146e-01
## ENSG00000000460 2.700376e-01 2.826398e-01
## ENSG00000000938 9.232794e-01 9.399669e-01
## ENSG00000000971 9.382227e-01 9.492325e-01
## ENSG00000001460 6.333969e-20 4.574862e-09
## 2394 more rows ...
## 
## @score
##                      edgeR       voom      DESeq2
## ENSG00000000457 0.22706080 0.23980596 0.274811698
## ENSG00000000460 0.31050478 0.27677537 0.359226203
## ENSG00000000938 0.04985025 0.03344113 0.001526355
## ENSG00000000971 0.03900847 0.02263371 0.008182751
## ENSG00000001460 3.81423112 4.18152876 3.741077290
## 2394 more rows ...
## 
## @truth
##                 status n_isoforms    logFC       logFC_cat       expr            expr_cat
## ENSG00000000457      0          5 0.000000 [ 0.000, 0.297)   8.525774 [2.85e+00,1.45e+01)
## ENSG00000000460      0         10 0.000000 [ 0.000, 0.297)   3.314544 [2.85e+00,1.45e+01)
## ENSG00000000938      0          8 0.000000 [ 0.000, 0.297)  11.543626 [2.85e+00,1.45e+01)
## ENSG00000000971      0          6 0.000000 [ 0.000, 0.297) 163.547797 [1.45e+01,2.43e+04]
## ENSG00000001460      1         13 3.939422 [ 3.540,24.063]   3.792523 [2.85e+00,1.45e+01)
## 3853 more rows ...</code></pre>
<p>For the methods that don’t have adjusted p-values, we will calculate adjusted p-values from nominal p-values.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">cobradata_example</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/calculate_adjp.html">calculate_adjp</a></span>(<span class="no">cobradata_example</span>)</pre></body></html></div>
<pre><code>## Adding empty sval slot to object</code></pre>
<pre><code>## Object up to date</code></pre>
</div>
<div id="calculating-performance-scores" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-performance-scores" class="anchor"></a>Calculating performance scores</h2>
<p>Next, we calculate the performance scores using the COBRAData object. We can perform both assignment-based and correlation-based evaluations, and thus we have to provide information about which columns in the truth data frame that are to be interpreted as the binary (assignment) truth and continuous truth score, respectively. Here, we let the “status” column (indicating the true differential expression status of the genes) represent the true classification, and the true log-fold change represent the true score, to which the observed scores will be compared.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">cobraperf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/calculate_performance.html">calculate_performance</a></span>(<span class="no">cobradata_example</span>, <span class="kw">binary_truth</span> <span class="kw">=</span> <span class="st">"status"</span>,
                                  <span class="kw">cont_truth</span> <span class="kw">=</span> <span class="st">"logFC"</span>, <span class="kw">splv</span> <span class="kw">=</span> <span class="st">"none"</span>,
                                  <span class="kw">maxsplit</span> <span class="kw">=</span> <span class="fl">4</span>)</pre></body></html></div>
<pre><code>## column edgeR is being ignored for FSR/NBR calculations</code></pre>
<pre><code>## column voom is being ignored for FSR/NBR calculations</code></pre>
<pre><code>## column DESeq2 is being ignored for FSR/NBR calculations</code></pre>
<pre><code>## column edgeR is being ignored for FSRNBR calculations</code></pre>
<pre><code>## column voom is being ignored for FSRNBR calculations</code></pre>
<pre><code>## column DESeq2 is being ignored for FSRNBR calculations</code></pre>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu">slotNames</span>(<span class="no">cobraperf</span>)</pre></body></html></div>
<pre><code>##  [1] "fdrtpr"      "fdrtprcurve" "fdrnbr"      "fdrnbrcurve" "fsrnbr"      "fsrnbrcurve"
##  [7] "deviation"   "tpr"         "fpr"         "roc"         "scatter"     "fpc"        
## [13] "overlap"     "corr"        "maxsplit"    "splv"        "onlyshared"</code></pre>
</div>
<div id="preparing-performance-object-for-plotting" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-performance-object-for-plotting" class="anchor"></a>Preparing performance object for plotting</h2>
<p>After calculating the performance scores, we prepare the object for plotting. In this step, we will assign colors to each of the methods, and we can decide to keep only a subset of the methods. We also decide whether the plotting should be done with or without facetting (i.e., splitting the plots into panels based on the stratification variable). This choice will determine the number of colors that are needed to distinguish between all method/stratification level combinations.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">cobraplot</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/prepare_data_for_plot.html">prepare_data_for_plot</a></span>(<span class="no">cobraperf</span>, <span class="kw">colorscheme</span> <span class="kw">=</span> <span class="st">"Dark2"</span>,
                                  <span class="kw">facetted</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
</div>
<div id="plotting" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting" class="anchor"></a>Plotting</h2>
<p>When the data has been prepared for plotting, we can apply any of the provided plot functions to visualize different aspects of the results.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_tpr.html">plot_tpr</a></span>(<span class="no">cobraplot</span>)</pre></body></html></div>
<p><img src="iCOBRA_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_fdrtprcurve.html">plot_fdrtprcurve</a></span>(<span class="no">cobraplot</span>)</pre></body></html></div>
<p><img src="iCOBRA_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_overlap.html">plot_overlap</a></span>(<span class="no">cobraplot</span>)</pre></body></html></div>
<p><img src="iCOBRA_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
</div>
<div id="modifications-to-the-basic-workflow" class="section level1">
<h1 class="hasAnchor">
<a href="#modifications-to-the-basic-workflow" class="anchor"></a>Modifications to the basic workflow</h1>
<div id="stratification" class="section level2">
<h2 class="hasAnchor">
<a href="#stratification" class="anchor"></a>Stratification</h2>
<p>All results can be stratified by any annotation provided in the truth slot of the COBRAData object. Note that only the largest categories will be retained (the number of retained categories is determined by the maxsplit argument), and thus stratifying by continuous annotations is not supported (each category would likely contain just one observation). Here, we show how the stratification is performed, and how it changes the plots generated above.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">cobraperf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/calculate_performance.html">calculate_performance</a></span>(<span class="no">cobradata_example</span>, <span class="kw">binary_truth</span> <span class="kw">=</span> <span class="st">"status"</span>,
                                  <span class="kw">cont_truth</span> <span class="kw">=</span> <span class="st">"status"</span>, <span class="kw">splv</span> <span class="kw">=</span> <span class="st">"expr_cat"</span>)</pre></body></html></div>
<pre><code>## column edgeR is being ignored for FSR/NBR calculations</code></pre>
<pre><code>## column voom is being ignored for FSR/NBR calculations</code></pre>
<pre><code>## column DESeq2 is being ignored for FSR/NBR calculations</code></pre>
<pre><code>## column edgeR is being ignored for FSRNBR calculations</code></pre>
<pre><code>## column voom is being ignored for FSRNBR calculations</code></pre>
<pre><code>## column DESeq2 is being ignored for FSRNBR calculations</code></pre>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">cobraplot</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/prepare_data_for_plot.html">prepare_data_for_plot</a></span>(<span class="no">cobraperf</span>, <span class="kw">colorscheme</span> <span class="kw">=</span> <span class="st">"Dark2"</span>,
                                  <span class="kw">facetted</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="../reference/plot_tpr.html">plot_tpr</a></span>(<span class="no">cobraplot</span>)</pre></body></html></div>
<p><img src="iCOBRA_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div id="modification-of-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#modification-of-plots" class="anchor"></a>Modification of plots</h2>
<p>The plotting functions (except plot_overlap) return ggplot objects. Some basic settings (such as the size of the plot characters, the size of the text in the panel headers and the axis ranges) can be set directly in the plot functions. Others can be modified manually. For example, to reduce the size of the axis labels, an appropriate theme can be added to the ggplot object returned by the plot functions:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="no">pp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/plot_tpr.html">plot_tpr</a></span>(<span class="no">cobraplot</span>, <span class="kw">stripsize</span> <span class="kw">=</span> <span class="fl">7.5</span>, <span class="kw">pointsize</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="no">pp</span> + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">angle</span> <span class="kw">=</span> <span class="fl">90</span>, <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.5</span>,
                                      <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>),
           <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>),
           <span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>),
           <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>))</pre></body></html></div>
<p><img src="iCOBRA_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>It is also possible to modify the facetting and/or label position by adding a facet_wrap statement (note that the stratification variable is denoted “splitval”):</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">pp</span> + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">angle</span> <span class="kw">=</span> <span class="fl">90</span>, <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.5</span>,
                                      <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>),
           <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>),
           <span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>),
           <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>),
           <span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"bottom"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(~<span class="no">splitval</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="iCOBRA_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>The plot_overlap function generates venn diagram(s), using the vennDiagram function from the limma package. It can be provided with any additional arguments that are accepted by limma::vennDiagram, e.g. to change the size of the text:</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_overlap.html">plot_overlap</a></span>(<span class="no">cobraplot</span>)</pre></body></html></div>
<p><img src="iCOBRA_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_overlap.html">plot_overlap</a></span>(<span class="no">cobraplot</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>))</pre></body></html></div>
<p><img src="iCOBRA_files/figure-html/unnamed-chunk-12-2.png" width="672"></p>
</div>
<div id="custom-color-assignment" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-color-assignment" class="anchor"></a>Custom color assignment</h2>
<p>The colors can either be chosen by one of the pre-defined color palettes, or provided by the user as a character vector. Note that the number of colors that are required depends on the facetting, and that not all methods may be shown in all plots (depending on the provided score types). If the wrong number of colors is provided, iCOBRA will automatically add or remove colors.</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">cobraplot</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/prepare_data_for_plot.html">prepare_data_for_plot</a></span>(<span class="no">cobraperf</span>,
                                  <span class="kw">colorscheme</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"pink"</span>),
                                  <span class="kw">facetted</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">pp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/plot_tpr.html">plot_tpr</a></span>(<span class="no">cobraplot</span>, <span class="kw">stripsize</span> <span class="kw">=</span> <span class="fl">7.5</span>, <span class="kw">pointsize</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="no">pp</span> + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">angle</span> <span class="kw">=</span> <span class="fl">90</span>, <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">0.5</span>,
                                      <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>),
           <span class="kw">axis.text.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>),
           <span class="kw">axis.title.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>),
           <span class="kw">axis.title.y</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">10</span>))</pre></body></html></div>
<p><img src="iCOBRA_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
<div id="interactive-exploration" class="section level2">
<h2 class="hasAnchor">
<a href="#interactive-exploration" class="anchor"></a>Interactive exploration</h2>
<p>iCOBRA contains an interactive shiny application, for interactive exploration of results. It can be called with an COBRAData object, or with no arguments. In the latter case, results can be loaded into the app from text files.</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="fu"><a href="../reference/COBRAapp.html">COBRAapp</a></span>(<span class="no">cobradata_example</span>)
<span class="fu"><a href="../reference/COBRAapp.html">COBRAapp</a></span>()</pre></body></html></div>
<p>Formatting instructions for the text files can be found in the Instructions tab. To generate text files from an existing COBRAData object, use the <code><a href="../reference/COBRAData.html">COBRAData_to_text()</a></code> function:</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="fu"><a href="../reference/COBRAData.html">COBRAData_to_text</a></span>(<span class="kw">cobradata</span> <span class="kw">=</span> <span class="no">cobradata_example</span>,
                  <span class="kw">truth_file</span> <span class="kw">=</span> <span class="st">"cobradata_truth.txt"</span>,
                  <span class="kw">result_files</span> <span class="kw">=</span> <span class="st">"cobradata_results.txt"</span>,
                  <span class="kw">feature_id</span> <span class="kw">=</span> <span class="st">"feature"</span>)</pre></body></html></div>
<p>Similarly, a COBRAData object can be generated from a set of text files, using the <code><a href="../reference/COBRAData.html">COBRAData_from_text()</a></code> function:</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">cobra</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/COBRAData.html">COBRAData_from_text</a></span>(<span class="kw">truth_file</span> <span class="kw">=</span> <span class="st">"cobradata_truth.txt"</span>,
                             <span class="kw">result_files</span> <span class="kw">=</span> <span class="st">"cobradata_results.txt"</span>,
                             <span class="kw">feature_id</span> <span class="kw">=</span> <span class="st">"feature"</span>)
<span class="no">cobra</span></pre></body></html></div>
<pre><code>## An object of class "COBRAData"
## @pval
##                        edgeR         voom       DESeq2
## ENSG00000000457 1.178024e-01 5.147484e-02 1.627063e-02
## ENSG00000000460 1.101413e-01 1.276784e-01 3.281416e-02
## ENSG00000000938 8.128245e-01 8.712829e-01 9.942761e-01
## ENSG00000000971 8.449686e-01 8.939493e-01 9.627826e-01
## ENSG00000001460 8.343203e-21 6.007010e-10 9.303159e-23
## 2394 more rows ...
## 
## @padj
##                        edgeR         voom       DESeq2
## ENSG00000000457 2.833295e-01 1.375146e-01 4.760152e-02
## ENSG00000000460 2.700376e-01 2.826398e-01 8.717737e-02
## ENSG00000000938 9.232794e-01 9.399669e-01 9.985675e-01
## ENSG00000000971 9.382227e-01 9.492325e-01 9.868048e-01
## ENSG00000001460 6.333969e-20 4.574862e-09 6.742682e-22
## 2394 more rows ...
## 
## @sval
## data frame with 0 columns and 0 rows
## 
## @score
##                      edgeR       voom      DESeq2
## ENSG00000000457 0.22706080 0.23980596 0.274811698
## ENSG00000000460 0.31050478 0.27677537 0.359226203
## ENSG00000000938 0.04985025 0.03344113 0.001526355
## ENSG00000000971 0.03900847 0.02263371 0.008182751
## ENSG00000001460 3.81423112 4.18152876 3.741077290
## 2394 more rows ...
## 
## @truth
##                         feature status n_isoforms    logFC       logFC_cat       expr
## ENSG00000000457 ENSG00000000457      0          5 0.000000 [ 0.000, 0.297)   8.525774
## ENSG00000000460 ENSG00000000460      0         10 0.000000 [ 0.000, 0.297)   3.314544
## ENSG00000000938 ENSG00000000938      0          8 0.000000 [ 0.000, 0.297)  11.543626
## ENSG00000000971 ENSG00000000971      0          6 0.000000 [ 0.000, 0.297) 163.547797
## ENSG00000001460 ENSG00000001460      1         13 3.939422 [ 3.540,24.063]   3.792523
##                            expr_cat
## ENSG00000000457 [2.85e+00,1.45e+01)
## ENSG00000000460 [2.85e+00,1.45e+01)
## ENSG00000000938 [2.85e+00,1.45e+01)
## ENSG00000000971 [1.45e+01,2.43e+04]
## ENSG00000001460 [2.85e+00,1.45e+01)
## 3853 more rows ...</code></pre>
<p>The screenshot below shows the appearance of the iCOBRA shiny app, using the example data set.</p>
<p><img src="screenshot_COBRAapp.png" style="width:800px;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Charlotte Soneson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
